<view wx:if="{{isAdmin}}">
  <tree
    dataTree="{{dataTree}}"
    selectKey="{{selectedCode}}"
    bind:select="handleSelect"
    isSelectLastNode="true"
    isOpenAll="{{false}}"
    checkBox="{{false}}"
  ></tree>
  <mp-cells title="当前分类" >
    <mp-cell>
      <view class="view-row">
        <view wx:if="{{selectedCode==''}}" >顶级</view>
        <view wx:else>{{selectedDisplayedCode}} {{selectedName}}</view>
      </view>
    </mp-cell>
  </mp-cells>
  <mp-cells title="修改分类名称" >
    <mp-cell>
      <view class="view-row" style="display: flex; justify-content: center;margin: 10rpx" >
        <input class="input" style="width: 350rpx;height: 60rpx; text-align: center;" 
        placeholder="{{selectedCategory.name}}" 
        disabled="{{selectedCategory == null || selectedCategory == undefined || selectedCategory.name == '' || modName == ''}}" 
        bindinput="setModName" />
       <view style="width: 50rpx;"></view>
        <button size="mini" class="input" style="margin: 5rpx" 
        disabled="{{selectedCategory == null || selectedCategory == undefined || selectedCategory.name == '' || modName == ''}}"  bind:tap="modCategoryName" >确认</button>
      </view>
    </mp-cell>
  </mp-cells>

  <mp-cells title="添加分类" >
    <mp-cell>
      <view class="view-row" >
        <view class="left-column" >分类序号：</view>
        <view class="right-column" class="view-row">
          <view>{{fatherDisplayedCode}}</view>
          <input id="newSeq" bindinput="setNewCategory" class="input" style="width: 50rpx;" disabled="{{selectedCategory == undefined}}" value="{{newSeq}}" /></view>
          <view style="width: 50rpx;"></view>
          <switch bindchange="checkSameLevel" disabled="{{selectedCategory == undefined}}" checked="{{isSameLevel}}"  >同级</switch>
      </view>
    </mp-cell>
    <mp-cell>
      <view class="view-row" >
        <view class="left-column" >分类名称：</view>
        <view class="right-column">
          <input id="newSeqName" bindinput="setNewCategory" class="input" style="width: 200rpx;" disabled="{{selectedCategory == undefined}}"  value="{{newName}}" />
        </view>
      </view>
    </mp-cell>
    <mp-cell>
      <button class="input" disabled="{{selectedCategory == undefined}}" bind:tap="addCategory"  > 添 加 分 类 </button>
    </mp-cell>
  </mp-cells>
  <mp-cells title="押金设定" >
    <view style="display:flex;justify-content: center;" >
      <input class="input" id="deposit" bindinput="setNumber" style="width: 150rpx; text-align: center;" value="{{selectedCategory.deposit}}" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" />
    </view>
  </mp-cells>
  <mp-cells title="价格设定" >
    <mp-cell>
      <view>
        <mp-tabs
        tabs="{{shops}}" 
        swiperClass="weui-tabs-swiper"
        bindtabclick="onTabCLick"
        bindchange="onTabChange"
        activeClass="tab-bar-title__selected"   
        >

          <block wx:for="{{shops}}" wx:key="title" >
            <view class="tab-content" slot="tab-content-{{index}}"  >
              <view style="margin-left: 0rpx;"  >
                <view class="view-row">
                  <view style="width:100rpx; text-align: center;width: 120rpx;text-align: center;" >-</view>
                  <view style="text-align: center;width: 150rpx;" >门市</view>
                  <view style="text-align: center;width: 150rpx;" >预约</view>
                  <view style="text-align: center;width: 150rpx;" >会员</view>
                </view>
                <view class="view-row">
                  <view style="width:100rpx; text-align: center;width: 120rpx;text-align: left;" >平日</view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_0_0" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][0][0]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_0_1" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][0][1]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_0_2" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][0][2]}}" /></view>
                </view>
                <view class="view-row">
                  <view style="width:100rpx; text-align: center;width: 120rpx;text-align: left;" >周末</view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_1_0" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][1][0]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_1_1" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][1][1]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_1_2" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][1][2]}}" /></view>
                </view>
                <view class="view-row">
                  <view style="width:100rpx; text-align: center; width: 120rpx;text-align: left;" >节假日</view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_2_0" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][2][0]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_2_1" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][2][1]}}" /></view>
                  <view style="text-align: center;width: 150rpx;margin:1rpx" ><input id="price_2_2" bindinput="setNumber" class="input" disabled="{{selectedCategory == undefined || selectedCategory.children != null}}" value="{{shopPriceArr[currentShopIndex][2][2]}}" /></view>
                </view>
              </view>
            </view>
          </block>

        </mp-tabs>
      </view>
     
      
    </mp-cell>
  </mp-cells>
  <mp-cells title="保存租金押金设置">
    <mp-cell>
        <view style="color: red;">{{canSave? '': canSaveMsg}}</view>
    </mp-cell>
    <mp-cell><button class="input" disabled="{{!canSave || isSaving}}" bind:tap="save" > 保 存 </button></mp-cell>
  </mp-cells>
  <mp-cells title="删除分类">
    <mp-cell>
      <button disabled="{{ (selectedCategory.children != undefined  && selectedCategory.children != null) || selectedCategory == undefined}}" class="input" bind:tap="metionDelete" > 删 除 </button>
    </mp-cell>
  </mp-cells>
</view>